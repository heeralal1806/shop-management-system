<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop System - Connection Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-card {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .pass { border-left: 4px solid #28a745; }
        .fail { border-left: 4px solid #dc3545; }
        .warn { border-left: 4px solid #ffc107; }
        h1 { color: #2c3e50; }
        h2 { color: #34495e; margin-top: 0; }
        .status { font-weight: bold; }
        .pass .status { color: #28a745; }
        .fail .status { color: #dc3545; }
        .warn .status { color: #ffc107; }
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        .btn:hover { background: #2980b9; }
        .btn-green { background: #27ae60; }
        .btn-green:hover { background: #219a52; }
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>üîß Shop System - Connection Diagnostic</h1>
    
    <div class="test-card">
        <h2>üìã Quick Fix</h2>
        <p>If links aren't working in Chrome, try these solutions:</p>
        <ol>
            <li><strong>Use Local Server</strong> (Most Reliable):
                <pre>cd /Users/singavaramheeralalsingh/Desktop/shop-management-system
python3 -m http.server 8000</pre>
                Then open: <strong>http://localhost:8000</strong>
            </li>
            <li><strong>Clear Chrome Cache:</strong> Press Ctrl+Shift+Delete, select "All time", click "Clear data"</li>
            <li><strong>Check Console:</strong> Press F12 ‚Üí Console tab for errors</li>
        </ol>
        <button class="btn btn-green" onclick="runAllTests()">‚ñ∂Ô∏è Run All Tests</button>
        <button class="btn" onclick="openMainApp()">üöÄ Open Main App (Local Server)</button>
    </div>

    <div id="results"></div>

    <script>
        const results = [];
        
        function addResult(name, passed, message) {
            results.push({ name, passed, message });
            const div = document.createElement('div');
            div.className = `test-card ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `
                <h2>${passed ? '‚úÖ' : '‚ùå'} ${name}</h2>
                <p class="status">${passed ? 'PASS' : 'FAIL'}</p>
                <p>${message}</p>
            `;
            document.getElementById('results').appendChild(div);
        }

        async function runAllTests() {
            document.getElementById('results').innerHTML = '';
            results.length = 0;
            
            // Test 1: Protocol
            const isFileProtocol = location.protocol === 'file:';
            addResult(
                'Protocol Check',
                true,
                `Current protocol: <strong>${location.protocol}</strong>` +
                (isFileProtocol ? '<br>‚ö†Ô∏è Using file:// protocol. Some features may be limited in Chrome.' : '<br>‚úÖ Using HTTP protocol. All features should work.')
            );

            // Test 2: Service Worker Support
            const swSupported = 'serviceWorker' in navigator;
            addResult(
                'Service Worker Support',
                swSupported,
                swSupported 
                    ? '‚úÖ Service Workers are supported in this browser' 
                    : '‚ùå Service Workers are NOT supported'
            );

            // Test 3: IndexedDB Support
            const idbSupported = 'indexedDB' in window;
            addResult(
                'IndexedDB Support',
                idbSupported,
                idbSupported 
                    ? '‚úÖ IndexedDB is supported' 
                    : '‚ùå IndexedDB is NOT supported'
            );

            // Test 4: Online Status
            const isOnline = navigator.onLine;
            addResult(
                'Network Status',
                true,
                isOnline 
                    ? '‚úÖ You are online' 
                    : '‚ö†Ô∏è You are offline (but app should still work!)'
            );

            // Test 5: Test IndexedDB
            try {
                await new Promise((resolve, reject) => {
                    const request = indexedDB.open('TestDB', 1);
                    request.onsuccess = () => {
                        request.result.close();
                        indexedDB.deleteDatabase('TestDB');
                        resolve(true);
                    };
                    request.onerror = () => reject(false);
                });
                addResult('IndexedDB Functionality', true, '‚úÖ IndexedDB is working correctly');
            } catch (e) {
                addResult('IndexedDB Functionality', false, '‚ùå IndexedDB test failed: ' + e.message);
            }

            // Test 6: Navigation Links
            const navItems = document.querySelectorAll('.nav-item');
            addResult(
                'Navigation Items Found',
                navItems.length > 0,
                `Found ${navItems.length} navigation items in the main app`
            );

            // Test 7: Console Debug Info
            console.log('=== Shop System Diagnostic ===');
            console.log('Protocol:', location.protocol);
            console.log('User Agent:', navigator.userAgent);
            console.log('Service Worker Supported:', swSupported);
            console.log('IndexedDB Supported:', idbSupported);
            console.log('Online:', isOnline);
            console.log('File Protocol Issues Expected:', isFileProtocol);
            
            addResult(
                'Console Logging',
                true,
                '‚úÖ Check browser console (F12) for detailed diagnostic information'
            );

            // Summary
            const summary = document.createElement('div');
            summary.className = 'test-card';
            const passCount = results.filter(r => r.passed).length;
            summary.innerHTML = `
                <h2>üìä Test Summary</h2>
                <p>Passed: ${passCount}/${results.length} tests</p>
                ${isFileProtocol 
                    ? '<p style="color: #dc3545;"><strong>‚ö†Ô∏è Recommendation: Use local server for full functionality</strong></p>' 
                    : '<p style="color: #28a745;"><strong>‚úÖ Your setup should work correctly!</strong></p>'}
            `;
            document.getElementById('results').appendChild(summary);
        }

        function openMainApp() {
            if (location.protocol === 'file:') {
                alert('Please use the local server for full functionality.\n\nRun this command in terminal:\n\ncd /Users/singavaramheeralalsingh/Desktop/shop-management-system\npython3 -m http.server 8000\n\nThen open: http://localhost:8000');
            } else {
                window.location.href = 'index.html';
            }
        }

        // Auto-run tests on load
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 500);
        });
    </script>
</body>
</html>

